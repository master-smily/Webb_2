function setup(){let a=document.getElementById("canvasDiv");createCanvas(WIDTH*SCL,HEIGHT*SCL).parent("canvasDiv"),a.style.width=WIDTH*SCL+"px";for(let a=0;a<WIDTH;a++){data.push([]);for(let b=0;b<HEIGHT;b++)data[a].push(new Block(a,b))}textAlign(CENTER,CENTER),textSize(.75*SCL),drawGrid(),dropBombs(BOMBS);for(let a=0;a<WIDTH;a++)for(let b=0;b<HEIGHT;b++)data[a][b].checkNeighbors();clock=createP(time("digital")).parent("canvasDiv")}function draw(){if(background(255),drawGrid(),clearingStack.length>0){let a=clearingStack.pop();data[a.x][a.y].clearNeighbours()}else if(!gameOver&&!paused){let a=Math.floor(map(mouseX,0,width,0,WIDTH)),b=Math.floor(map(mouseY,0,height,0,HEIGHT));count===freeBlocks&&(gameOver=!0,showBombs=!0,a=void 0,b=void 0,alert("you win after "+time())),fill(100),rect(a*SCL,b*SCL,SCL,SCL),clock.html(time("digital"))}}function mousePressed(){if(!gameOver&&!paused){let a=Math.floor(map(mouseX,0,width,0,WIDTH)),b=Math.floor(map(mouseY,0,height,0,HEIGHT));try{mouseButton===LEFT?(data[a][b].checked=!0,count++,data[a][b].bomb?(showBombs=!0,alert("Game Over after "+time()),gameOver=!0):8===data[a][b].neighbors.length&&data[a][b].clearNeighbours()):mouseButton===CENTER&&(data[a][b].mark^=!0)}catch(a){console.log(a),TypeError}}}function drawGrid(){for(let a=0;a<WIDTH;a++){let b=a*SCL;for(let c=0;c<HEIGHT;c++){let d=c*SCL;data[a][c].bomb&&showBombs?(fill(200,20,20),rect(b,d,SCL,SCL)):data[a][c].checked?(fill(245),rect(b,d,SCL,SCL),8!==data[a][c].neighbors.length&&(fill(10),text(8-data[a][c].neighbors.length,b,d,SCL,SCL))):data[a][c].mark?(fill(250,235,20),rect(b,d,SCL,SCL)):(fill(51),rect(b,d,SCL,SCL))}}}function dropBombs(a){let c,d,b=a;for(;b;)c=Math.floor(random(WIDTH-1)),d=Math.floor(random(HEIGHT-1)),data[c][d].bomb||(data[c][d].bomb=!0,b--)}function time(a){let b=millis(),c=Math.floor(b/6e4),d=Math.floor((b-6e4*c)/1e3);return"digital"===a?nf(c,2)+":"+nf(d,2):c>0?c+" minutes and "+d+" seconds":d+" seconds"}function settings(a){"open"===a?(document.getElementById("settings").style.display="block",paused=!0):"close"===a&&(document.getElementById("settings").style.display="none",paused=!1)}urlParams=new URLSearchParams(window.location.search);const WIDTH=urlParams.get("width"),HEIGHT=urlParams.get("height"),SCL=urlParams.get("scale"),BOMBS=urlParams.get("bombs");urlParams=[WIDTH,HEIGHT,SCL,BOMBS];var clock,showBombs=!1,gameOver=!1,paused=!1,freeBlocks=WIDTH*HEIGHT-BOMBS,count=0;let data=[],clearingStack=[];urlParams.includes(null)&&(settings("open"),paused=!0),delete urlParams;